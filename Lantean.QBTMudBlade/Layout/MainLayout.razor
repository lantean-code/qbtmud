@inherits LayoutComponentBase

<CascadingValue Value="DrawerOpen" Name="DrawerOpen">
    <EnhancedErrorBoundary @ref="ErrorBoundary" OnClear="Cleared">
        <MudThemeProvider @ref="MudThemeProvider" @bind-IsDarkMode="IsDarkMode" Theme="Theme" />
        <MudDialogProvider />
        <MudSnackbarProvider />
        <MudPopoverProvider />

        <PageTitle>qBittorrent Web UI</PageTitle>

        <MudLayout>
            <MudAppBar>
                <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="ToggleDrawer" />
                <MudText Typo="Typo.h5" Class="ml-3">qBittorrent Web UI</MudText>
                <MudSpacer />
                @if (ErrorBoundary?.Errors.Count > 0)
                {
                    <MudBadge Content="@(ErrorBoundary?.Errors.Count ?? 0)" Color="Color.Error" Overlap="true">
                        <MudIconButton Icon="@Icons.Material.Filled.Error" Color="Color.Default" OnClick="ToggleErrorDrawer" />
                    </MudBadge>
                }
                <MudSwitch T="bool" Label="Dark Mode" LabelPosition="LabelPosition.End" Value="IsDarkMode" ValueChanged="DarkModeChanged" />
                @if (ShowMenu)
                {
                    <Menu />
                }
            </MudAppBar>
            <MudDrawer Open="ErrorDrawerOpen" ClipMode="DrawerClipMode.Docked" Elevation="2" Anchor="Anchor.Right">
                <ErrorDisplay ErrorBoundary="ErrorBoundary" />
            </MudDrawer>
            <CascadingValue Value="Theme">
                <CascadingValue Value="IsDarkMode" Name="IsDarkMode">
                    @Body
                </CascadingValue>
            </CascadingValue>
        </MudLayout>
    </EnhancedErrorBoundary>
</CascadingValue>