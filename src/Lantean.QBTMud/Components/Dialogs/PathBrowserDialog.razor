@using Lantean.QBTMud.Helpers

<MudDialog Class="path-browser-dialog">
    <DialogContent>
        <div class="path-browser-dialog__content">
            <MudGrid>
                <MudItem xs="12">
                <MudTextField Label="@Translate("Current path")"
                              Value="_currentPath"
                              ValueChanged="@(async (string value) => await PathChanged(value))"
                              Variant="Variant.Outlined"
                              ShrinkLabel="true"
                              Immediate="true"
                              data-test-id="@TestIdHelper.For("CurrentPath")" />
            </MudItem>
                <MudItem xs="12">
                    <MudButtonGroup Variant="Variant.Outlined">
                        <MudIconButton Icon="@Icons.Material.Filled.ArrowUpward" Disabled="@(!CanNavigateUp)" OnClick="NavigateUp" title="@Translate("Up")" />
                        <MudIconButton Icon="@Icons.Material.Filled.Refresh" Disabled="@IsLoading" OnClick="Reload" title="@Translate("Refresh")" />
                    </MudButtonGroup>
                </MudItem>
                <MudItem xs="12">
                    <div class="path-browser-dialog__list">
                        @if (IsLoading)
                        {
                            <MudProgressLinear Indeterminate="true" data-test-id="@TestIdHelper.For("PathBrowserLoading")" />
                        }
                        else if (!string.IsNullOrWhiteSpace(LoadError))
                        {
                            <MudAlert Severity="Severity.Error"
                                      data-test-id="@TestIdHelper.For("PathBrowserLoadError")">@LoadError</MudAlert>
                        }
                        else if (_entries.Count == 0)
                        {
                            <MudText data-test-id="@TestIdHelper.For("PathBrowserEmpty")">@Translate("No items.")</MudText>
                        }
                        else
                        {
                            <MudList T="string" Dense="true">
                                @foreach (var entry in _entries)
                                {
                                    <MudListItem T="string"
                                                 OnClick="@(() => EntryClicked(entry))"
                                                 Icon="@(entry.IsDirectory? Icons.Material.Filled.Folder : Icons.Material.Filled.InsertDriveFile)"
                                                 Text="@entry.Name"
                                                 data-test-id="@TestIdHelper.For($"PathBrowserEntry-{entry.Name}")" />
                                }
                            </MudList>
                        }
                    </div>
                </MudItem>
            </MudGrid>
        </div>
    </DialogContent>
    <DialogActions>
        <MudButton Variant="Variant.Filled" Color="Color.Success" Disabled="@(!CanSelectFolder)" OnClick="SelectCurrentFolder" data-test-id="@TestIdHelper.For("SelectFolder")">@Translate("Select folder")</MudButton>
    </DialogActions>
</MudDialog>
